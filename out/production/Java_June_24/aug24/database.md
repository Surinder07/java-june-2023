-- list all the databases;
show databases;

-- to select database
use Employee;

-- to show tables in the database
show tables;

-- to list all the fields in the table
SELECT * FROM EMPLOYEE;

-- to list specific columns of the table
-- to list distinct values  
SELECT DISTINCT
EMPLOYEE_ADDRESS
FROM EMPLOYEE;

-- where
-- Put a certain condition
SELECT EMPLOYEE_NAME, EMPLOYEE_SALARY FROM EMPLOYEE
WHERE EMPLOYEE_SALARY > 60000;

-- Sort in order ,  by default in acending order
SELECT EMPLOYEE_NAME, EMPLOYEE_SALARY
FROM EMPLOYEE
ORDER BY EMPLOYEE_SALARY ;

-- Descending order
SELECT EMPLOYEE_NAME, EMPLOYEE_SALARY
FROM EMPLOYEE
ORDER BY EMPLOYEE_SALARY DESC;

-- AND OR (&& ||)

SELECT EMPLOYEE_NAME, EMPLOYEE_SALARY, EMPLOYEE_ADDRESS
FROM EMPLOYEE
WHERE EMPLOYEE_SALARY > 50000 OR EMPLOYEE_ADDRESS = 'JAPAN';

-- INSERT THE RECORDS
INSERT INTO EMPLOYEE
(EMPLOYEE_ID, EMPLOYEE_NAME,
EMPLOYEE_ADDRESS,EMPLOYEE_PHONE,
EMPLOYEE_SALARY, EMPLOYEE_GENDER,
EMP_JOIN_DATE)
VALUES
(1009, 'Raman', 'Toronto',123123456, 100000,'F', '2017-01-01');

desc EMPLOYEE ;

SELECT * FROM EMPLOYEE;

-- delete
-- DELETE FROM EMPLOYEE
-- WHERE EMPLOYEE_SALARY = 123;


-- UPDATE A RECORD

UPDATE EMPLOYEE
SET EMPLOYEE_ADDRESS = 'Toronto'
where EMPLOYEE_NAME = 'RAMAN';


-- LIMIT

SELECT * FROM EMPLOYEE
LIMIT 10;

-- functions
-- min and max function -- interview question

SELECT MAX(EMPLOYEE_SALARY)
FROM EMPLOYEE;


-- NESTED QUERY
-- * RETURN ALL THE RECORDS
SELECT *
FROM EMPLOYEE
WHERE
EMPLOYEE_SALARY  =  (SELECT MIN(EMPLOYEE_SALARY)FROM EMPLOYEE);

-- COUNT
SELECT COUNT(*) AS TotalEmployees from EMPLOYEE;


-- average
SELECT AVG(EMPLOYEE_SALARY) AS AvgSal from EMPLOYEE;

-- sum
SELECT SUM(EMPLOYEE_SALARY) AS AvgSal from EMPLOYEE;

-- Like  RETURN WITH WILD CARDS
SELECT * FROM EMPLOYEE  WHERE EMPLOYEE_ADDRESS LIKE '%O%';


-- IN
SELECT * FROM EMPLOYEE WHERE EMPLOYEE_ID IN(1001, 1005, 1006, 1008);

-- BETWEEN
SELECT * FROM EMPLOYEE
WHERE EMPLOYEE_SALARY
BETWEEN 30000 AND 60000;


-- JOINS
-- INNER JOIN
-- LEFT, RIGHT
-- FULL JOIN
-- SELF JOIN
-- OUTER JOIN


SELECT * FROM EMPLOYEE;

SELECT * FROM SALARY;

SELECT
e.EMPLOYEE_ID,
e.EMPLOYEE_NAME,
e.EMPLOYEE_SALARY,

s.FROM_DATE,
s.TO_DATE

FROM
SALARY s -- LEFT

LEFT JOIN
EMPLOYEE e  -- RIGHT
ON
e.EMPLOYEE_ID = s.EMPLOYEE_ID ;


-- INNER JOIN --- ALL THE COMMON DATA WE HAVE IN BOTH TABLES

-- LEFT JOIN --- EVERY THING FROM THE LEFT TABLE AND MATCHING RECORDS FROM THE
--                 RIGHT TABLE

-- RIGHT JOIN -- EVERYTHING FROM RIGHT TABLE AND MATCHIN FROM LEFT




-- TWO TABLES
-- STUDENT ID AND STUDENT NAME    - 10 RECORDS  - L
-- STUDENT ID AND STUDENT AGE   - 8 RECORDS   - R

-- MIN
-- INNER JOIN -- 8
-- LEFT JOIN -- 10
-- RIGHT JOIN -- 8


-- FULL OUTER JOIN

-- SELF JOIN
-- JOIN WITH SAM




-- 12 AM  -- TRIGGER -- CALL NAMEOFPROCEDURE

-- STORE PROCEDURE
-- CREATE PROCEDURE NAMEOFPROCEDURE(){
-- DELETE EVERYTHING FROM EMPLOYEE
-- INSERT NEW RECORDS
-- CREATE NEW TABLE  ETC
-- }


-- EXAMPLE OF STORED PROCEDURE
DELIMITER //

CREATE PROCEDURE CalculateAverageSalary(IN genderParam CHAR(1))
BEGIN
DECLARE avgSalary DECIMAL(18, 2);

    SELECT AVG(EMPLOYEE_SALARY) INTO avgSalary
    FROM EMPLOYEE
    WHERE EMPLOYEE_GENDER = genderParam;
    
    SELECT avgSalary AS AVERAGE_SALARY;
END;
//

DELIMITER ;
CALL CalculateAverageSalary('F'); -- Replace 'M' with the desired gender value




-- GROUP BY AND HAVING
SELECT EMPLOYEE_GENDER,
AVG(EMPLOYEE_SALARY) AS avgsalary

FROM EMPLOYEE

GROUP BY EMPLOYEE_GENDER
HAVING AVG(EMPLOYEE_SALARY) > 50000;







-- 